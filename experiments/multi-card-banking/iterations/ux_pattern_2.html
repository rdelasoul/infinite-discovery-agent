<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enterprise Approval Workflow - Multi-Card Banking Platform</title>
    <style>
        /* Geist Design System Implementation */
        :root {
            /* Gray Scale - Primary neutral palette */
            --ds-gray-100: #fafafa;
            --ds-gray-200: #eaeaea;
            --ds-gray-300: #999999;
            --ds-gray-400: #888888;
            --ds-gray-500: #666666;
            --ds-gray-600: #444444;
            --ds-gray-700: #333333;
            --ds-gray-800: #222222;
            --ds-gray-900: #111111;
            --ds-gray-1000: #000000;

            /* Blue - Interactive elements */
            --ds-blue-100: #e1f5fe;
            --ds-blue-500: #0070f3;
            --ds-blue-600: #0061d5;
            --ds-blue-700: #004fc4;

            /* Status Colors */
            --ds-red-500: #ee0000;
            --ds-amber-500: #f5a623;
            --ds-green-500: #00b341;
            --ds-purple-500: #7c3aed;

            /* Typography */
            --font-size-h1: 2.25rem;
            --font-size-h2: 1.875rem;
            --font-size-h3: 1.5rem;
            --font-size-base: 1rem;
            --font-size-small: 0.875rem;
            --font-size-xs: 0.75rem;

            /* Spacing scale based on 8px grid */
            --space-1: 0.25rem;
            --space-2: 0.5rem;
            --space-3: 0.75rem;
            --space-4: 1rem;
            --space-6: 1.5rem;
            --space-8: 2rem;
            --space-12: 3rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Geist Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: var(--ds-gray-100);
            color: var(--ds-gray-900);
            line-height: 1.5;
        }

        /* Layout Components */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--space-8);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-8);
            padding-bottom: var(--space-6);
            border-bottom: 1px solid var(--ds-gray-200);
        }

        .header-left h1 {
            font-size: var(--font-size-h2);
            font-weight: 600;
            margin-bottom: var(--space-2);
        }

        .header-meta {
            color: var(--ds-gray-600);
            font-size: var(--font-size-small);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3);
            background: white;
            border: 1px solid var(--ds-gray-200);
            border-radius: 8px;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--ds-blue-500);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .user-info h3 {
            font-size: var(--font-size-small);
            font-weight: 600;
        }

        .user-role {
            font-size: var(--font-size-xs);
            color: var(--ds-gray-600);
        }

        /* Workflow Tabs */
        .workflow-tabs {
            display: flex;
            gap: var(--space-2);
            margin-bottom: var(--space-8);
            background: white;
            border: 1px solid var(--ds-gray-200);
            border-radius: 8px;
            padding: var(--space-1);
        }

        .workflow-tab {
            padding: var(--space-3) var(--space-6);
            border-radius: 6px;
            border: none;
            background: transparent;
            color: var(--ds-gray-600);
            font-size: var(--font-size-small);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .workflow-tab.active {
            background: var(--ds-blue-500);
            color: white;
        }

        .workflow-tab:hover:not(.active) {
            background: var(--ds-gray-100);
        }

        .tab-badge {
            background: var(--ds-red-500);
            color: white;
            font-size: var(--font-size-xs);
            padding: var(--space-1) var(--space-2);
            border-radius: 4px;
            font-weight: 600;
        }

        .tab-badge.active-tab {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Bulk Actions Bar */
        .bulk-actions {
            display: none;
            background: var(--ds-blue-100);
            border: 1px solid var(--ds-blue-500);
            border-radius: 8px;
            padding: var(--space-4);
            margin-bottom: var(--space-6);
            align-items: center;
            gap: var(--space-4);
        }

        .bulk-actions.show {
            display: flex;
        }

        .bulk-info {
            flex: 1;
            font-weight: 500;
            color: var(--ds-blue-700);
        }

        .bulk-buttons {
            display: flex;
            gap: var(--space-3);
        }

        .btn {
            padding: var(--space-2) var(--space-4);
            border-radius: 6px;
            border: none;
            font-size: var(--font-size-small);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .btn-primary {
            background: var(--ds-blue-500);
            color: white;
        }

        .btn-primary:hover {
            background: var(--ds-blue-600);
        }

        .btn-secondary {
            background: white;
            color: var(--ds-gray-700);
            border: 1px solid var(--ds-gray-300);
        }

        .btn-secondary:hover {
            border-color: var(--ds-gray-400);
        }

        .btn-ghost {
            background: transparent;
            color: var(--ds-gray-600);
        }

        .btn-ghost:hover {
            background: var(--ds-gray-100);
        }

        /* Approval Table */
        .approval-table {
            background: white;
            border: 1px solid var(--ds-gray-200);
            border-radius: 12px;
            overflow: hidden;
        }

        .table-header {
            background: var(--ds-gray-100);
            padding: var(--space-4) var(--space-6);
            border-bottom: 1px solid var(--ds-gray-200);
            display: grid;
            grid-template-columns: 40px 1fr 120px 120px 120px 100px 120px;
            gap: var(--space-4);
            align-items: center;
            font-weight: 600;
            font-size: var(--font-size-small);
            color: var(--ds-gray-700);
        }

        .approval-row {
            padding: var(--space-4) var(--space-6);
            border-bottom: 1px solid var(--ds-gray-200);
            display: grid;
            grid-template-columns: 40px 1fr 120px 120px 120px 100px 120px;
            gap: var(--space-4);
            align-items: center;
            transition: background 0.15s ease;
            cursor: pointer;
        }

        .approval-row:hover {
            background: var(--ds-gray-100);
        }

        .approval-row:last-child {
            border-bottom: none;
        }

        .approval-row.selected {
            background: var(--ds-blue-100);
            border-color: var(--ds-blue-500);
        }

        .row-checkbox {
            width: 18px;
            height: 18px;
            border: 2px solid var(--ds-gray-300);
            border-radius: 4px;
            cursor: pointer;
            position: relative;
        }

        .row-checkbox.checked {
            background: var(--ds-blue-500);
            border-color: var(--ds-blue-500);
        }

        .row-checkbox.checked::after {
            content: 'âœ“';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: var(--font-size-xs);
            font-weight: 600;
        }

        .expense-details {
            display: flex;
            flex-direction: column;
            gap: var(--space-1);
        }

        .expense-title {
            font-weight: 500;
            color: var(--ds-gray-900);
        }

        .expense-meta {
            font-size: var(--font-size-xs);
            color: var(--ds-gray-600);
        }

        .amount {
            font-weight: 600;
            text-align: right;
        }

        .amount.negative {
            color: var(--ds-red-500);
        }

        .amount.positive {
            color: var(--ds-green-500);
        }

        .card-badge {
            padding: var(--space-1) var(--space-2);
            border-radius: 4px;
            font-size: var(--font-size-xs);
            font-weight: 500;
            text-align: center;
        }

        .card-amex {
            background: #e6f3ff;
            color: #0066cc;
        }

        .card-chase {
            background: #e6f7ff;
            color: #1890ff;
        }

        .card-capital {
            background: #fff0e6;
            color: #d46b08;
        }

        .card-citi {
            background: #f6ffed;
            color: #52c41a;
        }

        .department-badge {
            padding: var(--space-1) var(--space-2);
            border-radius: 4px;
            font-size: var(--font-size-xs);
            font-weight: 500;
            text-align: center;
        }

        .dept-marketing {
            background: #fff1f0;
            color: #cf1322;
        }

        .dept-it {
            background: #f0f5ff;
            color: #1890ff;
        }

        .dept-operations {
            background: #f6ffed;
            color: #52c41a;
        }

        .dept-executive {
            background: #f9f0ff;
            color: #722ed1;
        }

        .approval-status {
            padding: var(--space-1) var(--space-2);
            border-radius: 4px;
            font-size: var(--font-size-xs);
            font-weight: 500;
            text-align: center;
        }

        .status-pending {
            background: #fff4e6;
            color: #b45309;
        }

        .status-review {
            background: #e6f7ff;
            color: #1890ff;
        }

        .status-escalated {
            background: #fff1f0;
            color: #cf1322;
        }

        .status-policy-check {
            background: #f9f0ff;
            color: #722ed1;
        }

        .action-buttons {
            display: flex;
            gap: var(--space-2);
        }

        .action-btn {
            padding: var(--space-1) var(--space-3);
            border-radius: 4px;
            border: none;
            font-size: var(--font-size-xs);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .action-approve {
            background: var(--ds-green-500);
            color: white;
        }

        .action-approve:hover {
            background: #009100;
        }

        .action-reject {
            background: var(--ds-red-500);
            color: white;
        }

        .action-reject:hover {
            background: #cc0000;
        }

        .action-details {
            background: var(--ds-gray-200);
            color: var(--ds-gray-700);
        }

        .action-details:hover {
            background: var(--ds-gray-300);
        }

        /* Policy Alerts */
        .policy-alerts {
            margin-bottom: var(--space-8);
        }

        .alert {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-4);
            border-radius: 8px;
            margin-bottom: var(--space-3);
        }

        .alert-warning {
            background: #fff4e6;
            border: 1px solid var(--ds-amber-500);
        }

        .alert-error {
            background: #fff1f0;
            border: 1px solid var(--ds-red-500);
        }

        .alert-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-xs);
            font-weight: 600;
        }

        .alert-warning .alert-icon {
            background: var(--ds-amber-500);
            color: white;
        }

        .alert-error .alert-icon {
            background: var(--ds-red-500);
            color: white;
        }

        .alert-content {
            flex: 1;
        }

        .alert-title {
            font-weight: 600;
            margin-bottom: var(--space-1);
        }

        .alert-description {
            font-size: var(--font-size-small);
            color: var(--ds-gray-600);
        }

        /* Approval Chain Visualization */
        .approval-chain {
            background: white;
            border: 1px solid var(--ds-gray-200);
            border-radius: 12px;
            padding: var(--space-6);
            margin-bottom: var(--space-8);
        }

        .chain-header {
            margin-bottom: var(--space-6);
        }

        .chain-steps {
            display: flex;
            align-items: center;
            gap: var(--space-4);
            overflow-x: auto;
            padding-bottom: var(--space-2);
        }

        .chain-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 120px;
            text-align: center;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-bottom: var(--space-2);
            border: 2px solid var(--ds-gray-300);
            background: white;
        }

        .step-circle.completed {
            background: var(--ds-green-500);
            color: white;
            border-color: var(--ds-green-500);
        }

        .step-circle.current {
            background: var(--ds-blue-500);
            color: white;
            border-color: var(--ds-blue-500);
        }

        .step-circle.pending {
            background: var(--ds-gray-200);
            color: var(--ds-gray-600);
        }

        .step-title {
            font-size: var(--font-size-small);
            font-weight: 500;
            margin-bottom: var(--space-1);
        }

        .step-subtitle {
            font-size: var(--font-size-xs);
            color: var(--ds-gray-600);
        }

        .step-connector {
            flex: 1;
            height: 2px;
            background: var(--ds-gray-300);
            margin: 0 var(--space-2);
        }

        .step-connector.completed {
            background: var(--ds-green-500);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .table-header,
            .approval-row {
                grid-template-columns: 40px 1fr 80px 80px 100px;
                gap: var(--space-2);
            }
            
            .card-badge,
            .department-badge {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: var(--space-4);
            }
            
            .header {
                flex-direction: column;
                gap: var(--space-4);
                align-items: flex-start;
            }
            
            .workflow-tabs {
                flex-wrap: wrap;
            }
            
            .table-header,
            .approval-row {
                grid-template-columns: 40px 1fr 80px;
                gap: var(--space-2);
            }
            
            .approval-status,
            .action-buttons {
                display: none;
            }
            
            .chain-steps {
                flex-direction: column;
                gap: var(--space-6);
            }
            
            .step-connector {
                width: 2px;
                height: 30px;
                margin: var(--space-2) 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1>Expense Approval Workflow</h1>
                <div class="header-meta">18 pending approvals â€¢ $47,750 total value â€¢ Multi-level approval required</div>
            </div>
            <div class="header-right">
                <div class="user-profile">
                    <div class="avatar">MR</div>
                    <div class="user-info">
                        <h3>Mike Rodriguez</h3>
                        <div class="user-role">Finance Manager</div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Workflow Tabs -->
        <div class="workflow-tabs">
            <button class="workflow-tab active" onclick="switchWorkflow('pending')">
                Pending Approval
                <span class="tab-badge active-tab">18</span>
            </button>
            <button class="workflow-tab" onclick="switchWorkflow('review')">
                In Review
                <span class="tab-badge">7</span>
            </button>
            <button class="workflow-tab" onclick="switchWorkflow('escalated')">
                Escalated
                <span class="tab-badge">3</span>
            </button>
            <button class="workflow-tab" onclick="switchWorkflow('policy')">
                Policy Check
                <span class="tab-badge">5</span>
            </button>
            <button class="workflow-tab" onclick="switchWorkflow('completed')">
                Completed Today
            </button>
        </div>

        <!-- Policy Alerts -->
        <div class="policy-alerts">
            <div class="alert alert-error">
                <div class="alert-icon">!</div>
                <div class="alert-content">
                    <div class="alert-title">Policy Violation Alert</div>
                    <div class="alert-description">3 expenses exceed department meal limits ($50). Requires director approval before processing.</div>
                </div>
            </div>

            <div class="alert alert-warning">
                <div class="alert-icon">!</div>
                <div class="alert-content">
                    <div class="alert-title">Budget Variance Warning</div>
                    <div class="alert-description">Marketing team is approaching monthly budget limit. 5 pending approvals may exceed allocated budget.</div>
                </div>
            </div>
        </div>

        <!-- Approval Chain Visualization -->
        <div class="approval-chain">
            <div class="chain-header">
                <h3 class="section-title">Approval Chain: Marketing Campaign Software ($8,500)</h3>
                <div class="header-meta">Submitted by Jennifer Park â€¢ 2 hours ago â€¢ Requires CFO approval</div>
            </div>
            <div class="chain-steps">
                <div class="chain-step">
                    <div class="step-circle completed">âœ“</div>
                    <div class="step-title">Submitted</div>
                    <div class="step-subtitle">Jennifer Park</div>
                </div>
                <div class="step-connector completed"></div>
                <div class="chain-step">
                    <div class="step-circle completed">âœ“</div>
                    <div class="step-title">Manager Review</div>
                    <div class="step-subtitle">Mike Rodriguez</div>
                </div>
                <div class="step-connector completed"></div>
                <div class="chain-step">
                    <div class="step-circle current">3</div>
                    <div class="step-title">Director Approval</div>
                    <div class="step-subtitle">Awaiting Response</div>
                </div>
                <div class="step-connector"></div>
                <div class="chain-step">
                    <div class="step-circle pending">4</div>
                    <div class="step-title">CFO Approval</div>
                    <div class="step-subtitle">Sarah Chen</div>
                </div>
                <div class="step-connector"></div>
                <div class="chain-step">
                    <div class="step-circle pending">5</div>
                    <div class="step-title">Processing</div>
                    <div class="step-subtitle">Finance Team</div>
                </div>
            </div>
        </div>

        <!-- Bulk Actions -->
        <div class="bulk-actions" id="bulk-actions">
            <div class="bulk-info">
                <span id="selected-count">3</span> expenses selected
            </div>
            <div class="bulk-buttons">
                <button class="btn btn-primary" onclick="bulkApprove()">Approve Selected</button>
                <button class="btn btn-secondary" onclick="bulkReject()">Reject Selected</button>
                <button class="btn btn-ghost" onclick="clearSelection()">Clear Selection</button>
            </div>
        </div>

        <!-- Approval Table -->
        <div class="approval-table">
            <div class="table-header">
                <div></div>
                <div>Expense Details</div>
                <div>Amount</div>
                <div>Card</div>
                <div>Department</div>
                <div>Status</div>
                <div>Actions</div>
            </div>

            <div class="approval-row" onclick="toggleSelection(this)">
                <div class="row-checkbox"></div>
                <div class="expense-details">
                    <div class="expense-title">Google Ads Campaign - Q4 Holiday</div>
                    <div class="expense-meta">Jennifer Park â€¢ Marketing â€¢ 2 hours ago â€¢ Ref: GA-Q4-2024-001</div>
                </div>
                <div class="amount negative">-$8,500</div>
                <div class="card-badge card-capital">Capital One</div>
                <div class="department-badge dept-marketing">Marketing</div>
                <div class="approval-status status-escalated">Escalated</div>
                <div class="action-buttons">
                    <button class="action-btn action-approve" onclick="approveExpense(event, 'GA-Q4-2024-001')">Approve</button>
                    <button class="action-btn action-details" onclick="viewDetails(event, 'GA-Q4-2024-001')">Details</button>
                </div>
            </div>

            <div class="approval-row" onclick="toggleSelection(this)">
                <div class="row-checkbox"></div>
                <div class="expense-details">
                    <div class="expense-title">Salesforce Enterprise License Renewal</div>
                    <div class="expense-meta">David Kim â€¢ IT Department â€¢ 4 hours ago â€¢ Ref: SF-RENEW-2024</div>
                </div>
                <div class="amount negative">-$5,000</div>
                <div class="card-badge card-citi">Citi Corporate</div>
                <div class="department-badge dept-it">IT</div>
                <div class="approval-status status-pending">Pending</div>
                <div class="action-buttons">
                    <button class="action-btn action-approve" onclick="approveExpense(event, 'SF-RENEW-2024')">Approve</button>
                    <button class="action-btn action-details" onclick="viewDetails(event, 'SF-RENEW-2024')">Details</button>
                </div>
            </div>

            <div class="approval-row" onclick="toggleSelection(this)">
                <div class="row-checkbox"></div>
                <div class="expense-details">
                    <div class="expense-title">Conference Room Equipment Upgrade</div>
                    <div class="expense-meta">Operations Team â€¢ 6 hours ago â€¢ Ref: OPS-EQUIP-024</div>
                </div>
                <div class="amount negative">-$2,500</div>
                <div class="card-badge card-chase">Chase Ink</div>
                <div class="department-badge dept-operations">Operations</div>
                <div class="approval-status status-review">In Review</div>
                <div class="action-buttons">
                    <button class="action-btn action-approve" onclick="approveExpense(event, 'OPS-EQUIP-024')">Approve</button>
                    <button class="action-btn action-details" onclick="viewDetails(event, 'OPS-EQUIP-024')">Details</button>
                </div>
            </div>

            <div class="approval-row" onclick="toggleSelection(this)">
                <div class="row-checkbox"></div>
                <div class="expense-details">
                    <div class="expense-title">Executive Travel - Client Meeting NYC</div>
                    <div class="expense-meta">Sarah Chen â€¢ Executive â€¢ Yesterday â€¢ Ref: EXEC-TRAVEL-078</div>
                </div>
                <div class="amount negative">-$1,850</div>
                <div class="card-badge card-amex">AmEx Platinum</div>
                <div class="department-badge dept-executive">Executive</div>
                <div class="approval-status status-pending">Pending</div>
                <div class="action-buttons">
                    <button class="action-btn action-approve" onclick="approveExpense(event, 'EXEC-TRAVEL-078')">Approve</button>
                    <button class="action-btn action-details" onclick="viewDetails(event, 'EXEC-TRAVEL-078')">Details</button>
                </div>
            </div>

            <div class="approval-row" onclick="toggleSelection(this)">
                <div class="row-checkbox"></div>
                <div class="expense-details">
                    <div class="expense-title">Adobe Creative Suite Team License</div>
                    <div class="expense-meta">Jennifer Park â€¢ Marketing â€¢ Yesterday â€¢ Ref: ADOBE-TEAM-2024</div>
                </div>
                <div class="amount negative">-$1,200</div>
                <div class="card-badge card-capital">Capital One</div>
                <div class="department-badge dept-marketing">Marketing</div>
                <div class="approval-status status-policy-check">Policy Check</div>
                <div class="action-buttons">
                    <button class="action-btn action-approve" onclick="approveExpense(event, 'ADOBE-TEAM-2024')">Approve</button>
                    <button class="action-btn action-details" onclick="viewDetails(event, 'ADOBE-TEAM-2024')">Details</button>
                </div>
            </div>

            <div class="approval-row" onclick="toggleSelection(this)">
                <div class="row-checkbox"></div>
                <div class="expense-details">
                    <div class="expense-title">Office Supplies & Equipment</div>
                    <div class="expense-meta">Operations Team â€¢ Yesterday â€¢ Ref: OFF-SUPPLY-156</div>
                </div>
                <div class="amount negative">-$850</div>
                <div class="card-badge card-chase">Chase Ink</div>
                <div class="department-badge dept-operations">Operations</div>
                <div class="approval-status status-pending">Pending</div>
                <div class="action-buttons">
                    <button class="action-btn action-approve" onclick="approveExpense(event, 'OFF-SUPPLY-156')">Approve</button>
                    <button class="action-btn action-details" onclick="viewDetails(event, 'OFF-SUPPLY-156')">Details</button>
                </div>
            </div>

            <div class="approval-row" onclick="toggleSelection(this)">
                <div class="row-checkbox"></div>
                <div class="expense-details">
                    <div class="expense-title">Team Lunch - Client Meeting</div>
                    <div class="expense-meta">Mike Rodriguez â€¢ Finance â€¢ 2 days ago â€¢ Ref: MEAL-CLIENT-089</div>
                </div>
                <div class="amount negative">-$125</div>
                <div class="card-badge card-amex">AmEx Platinum</div>
                <div class="department-badge dept-executive">Executive</div>
                <div class="approval-status status-policy-check">Policy Check</div>
                <div class="action-buttons">
                    <button class="action-btn action-reject" onclick="rejectExpense(event, 'MEAL-CLIENT-089')">Reject</button>
                    <button class="action-btn action-details" onclick="viewDetails(event, 'MEAL-CLIENT-089')">Details</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enterprise approval workflow optimization and state management
        let selectedExpenses = new Set();
        let currentWorkflow = 'pending';
        
        function switchWorkflow(workflow) {
            currentWorkflow = workflow;
            
            // Update active tab
            document.querySelectorAll('.workflow-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Filter and display relevant expenses
            filterExpensesByWorkflow(workflow);
            
            // Update tab badges
            updateTabBadges();
        }
        
        function filterExpensesByWorkflow(workflow) {
            const rows = document.querySelectorAll('.approval-row');
            
            rows.forEach(row => {
                const status = row.querySelector('.approval-status').textContent.toLowerCase();
                let shouldShow = false;
                
                switch(workflow) {
                    case 'pending':
                        shouldShow = status.includes('pending');
                        break;
                    case 'review':
                        shouldShow = status.includes('review');
                        break;
                    case 'escalated':
                        shouldShow = status.includes('escalated');
                        break;
                    case 'policy':
                        shouldShow = status.includes('policy');
                        break;
                    case 'completed':
                        shouldShow = status.includes('completed') || status.includes('approved');
                        break;
                }
                
                row.style.display = shouldShow ? 'grid' : 'none';
            });
        }
        
        function toggleSelection(row) {
            // Prevent event bubbling from action buttons
            if (event.target.classList.contains('action-btn')) {
                return;
            }
            
            const checkbox = row.querySelector('.row-checkbox');
            const expenseId = row.querySelector('.expense-meta').textContent.split('Ref: ')[1];
            
            if (checkbox.classList.contains('checked')) {
                checkbox.classList.remove('checked');
                selectedExpenses.delete(expenseId);
                row.classList.remove('selected');
            } else {
                checkbox.classList.add('checked');
                selectedExpenses.add(expenseId);
                row.classList.add('selected');
            }
            
            updateBulkActions();
        }
        
        function updateBulkActions() {
            const bulkActions = document.getElementById('bulk-actions');
            const selectedCount = document.getElementById('selected-count');
            
            if (selectedExpenses.size > 0) {
                bulkActions.classList.add('show');
                selectedCount.textContent = selectedExpenses.size;
            } else {
                bulkActions.classList.remove('show');
            }
        }
        
        function clearSelection() {
            selectedExpenses.clear();
            document.querySelectorAll('.row-checkbox').forEach(checkbox => {
                checkbox.classList.remove('checked');
            });
            document.querySelectorAll('.approval-row').forEach(row => {
                row.classList.remove('selected');
            });
            updateBulkActions();
        }
        
        function bulkApprove() {
            if (selectedExpenses.size === 0) return;
            
            const expenseIds = Array.from(selectedExpenses);
            
            // Simulate approval processing
            showToast(`Approving ${expenseIds.length} expenses...`, 'success');
            
            // In real implementation, would send approval requests to backend
            setTimeout(() => {
                expenseIds.forEach(id => {
                    processApproval(id, 'approved');
                });
                clearSelection();
                showToast(`${expenseIds.length} expenses approved successfully`, 'success');
            }, 1500);
        }
        
        function bulkReject() {
            if (selectedExpenses.size === 0) return;
            
            const expenseIds = Array.from(selectedExpenses);
            
            // Show rejection reason modal in real implementation
            const reason = prompt('Rejection reason (required):');
            if (!reason) return;
            
            showToast(`Rejecting ${expenseIds.length} expenses...`, 'warning');
            
            setTimeout(() => {
                expenseIds.forEach(id => {
                    processApproval(id, 'rejected', reason);
                });
                clearSelection();
                showToast(`${expenseIds.length} expenses rejected`, 'warning');
            }, 1500);
        }
        
        function approveExpense(event, expenseId) {
            event.stopPropagation();
            
            showToast(`Approving expense ${expenseId}...`, 'success');
            
            setTimeout(() => {
                processApproval(expenseId, 'approved');
                showToast(`Expense ${expenseId} approved`, 'success');
            }, 1000);
        }
        
        function rejectExpense(event, expenseId) {
            event.stopPropagation();
            
            // Show rejection reason modal in real implementation
            const reason = prompt('Rejection reason (required):');
            if (!reason) return;
            
            showToast(`Rejecting expense ${expenseId}...`, 'warning');
            
            setTimeout(() => {
                processApproval(expenseId, 'rejected', reason);
                showToast(`Expense ${expenseId} rejected`, 'warning');
            }, 1000);
        }
        
        function processApproval(expenseId, action, reason = null) {
            // Find and update the expense row
            const rows = document.querySelectorAll('.approval-row');
            rows.forEach(row => {
                const meta = row.querySelector('.expense-meta').textContent;
                if (meta.includes(expenseId)) {
                    const statusElement = row.querySelector('.approval-status');
                    const actionButtons = row.querySelector('.action-buttons');
                    
                    if (action === 'approved') {
                        statusElement.textContent = 'Approved';
                        statusElement.className = 'approval-status status-approved';
                        statusElement.style.background = '#e8f5e8';
                        statusElement.style.color = '#1b5e1f';
                    } else if (action === 'rejected') {
                        statusElement.textContent = 'Rejected';
                        statusElement.className = 'approval-status status-rejected';
                        statusElement.style.background = '#fff1f0';
                        statusElement.style.color = '#cf1322';
                    }
                    
                    // Update action buttons
                    actionButtons.innerHTML = `
                        <button class="action-btn action-details" onclick="viewDetails(event, '${expenseId}')">Details</button>
                    `;
                    
                    // Remove from current view after animation
                    setTimeout(() => {
                        if (currentWorkflow !== 'completed') {
                            row.style.opacity = '0.5';
                            row.style.transform = 'translateX(20px)';
                            setTimeout(() => {
                                row.style.display = 'none';
                            }, 300);
                        }
                    }, 1000);
                }
            });
            
            // Update approval chain if this is the featured expense
            updateApprovalChain(expenseId, action);
        }
        
        function updateApprovalChain(expenseId, action) {
            // Simulate approval chain progression
            const currentStep = document.querySelector('.step-circle.current');
            if (currentStep && action === 'approved') {
                currentStep.classList.remove('current');
                currentStep.classList.add('completed');
                currentStep.innerHTML = 'âœ“';
                
                // Move to next step
                const nextStep = currentStep.parentElement.nextElementSibling?.nextElementSibling?.querySelector('.step-circle');
                if (nextStep && nextStep.classList.contains('pending')) {
                    nextStep.classList.remove('pending');
                    nextStep.classList.add('current');
                }
                
                // Update connector
                const connector = currentStep.parentElement.nextElementSibling;
                if (connector && connector.classList.contains('step-connector')) {
                    connector.classList.add('completed');
                }
            }
        }
        
        function viewDetails(event, expenseId) {
            event.stopPropagation();
            
            // In real implementation, would open detailed expense view
            showToast(`Loading details for expense ${expenseId}...`, 'info');
            
            // Simulate navigation to expense details
            setTimeout(() => {
                showToast(`Expense details loaded for ${expenseId}`, 'info');
            }, 1000);
        }
        
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            let backgroundColor;
            
            switch(type) {
                case 'success':
                    backgroundColor = 'var(--ds-green-500)';
                    break;
                case 'warning':
                    backgroundColor = 'var(--ds-amber-500)';
                    break;
                case 'error':
                    backgroundColor = 'var(--ds-red-500)';
                    break;
                default:
                    backgroundColor = 'var(--ds-blue-500)';
            }
            
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${backgroundColor};
                color: white;
                padding: var(--space-4);
                border-radius: 8px;
                z-index: 1000;
                font-weight: 500;
                max-width: 300px;
                animation: slideInRight 0.3s ease;
            `;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }
        
        function updateTabBadges() {
            // Simulate real-time updates to approval counts
            const badges = document.querySelectorAll('.tab-badge');
            badges.forEach(badge => {
                if (Math.random() < 0.3) {
                    const currentCount = parseInt(badge.textContent);
                    const change = Math.random() < 0.5 ? -1 : 1;
                    const newCount = Math.max(0, currentCount + change);
                    badge.textContent = newCount;
                    
                    if (newCount === 0) {
                        badge.style.display = 'none';
                    } else {
                        badge.style.display = 'inline-block';
                    }
                }
            });
        }
        
        // Auto-refresh approval data
        function autoRefresh() {
            setInterval(() => {
                updateTabBadges();
                
                // Simulate new approvals coming in
                if (Math.random() < 0.1) {
                    showToast('New expense submitted for approval', 'info');
                }
            }, 30000); // Every 30 seconds
        }
        
        // Policy compliance checking
        function checkPolicyCompliance(expense) {
            // Simulate policy rule checking
            const amount = parseFloat(expense.amount.replace(/[$,]/g, ''));
            const category = expense.category;
            const department = expense.department;
            
            const violations = [];
            
            // Check meal limits
            if (category === 'meals' && amount > 50) {
                violations.push('Exceeds meal policy limit ($50)');
            }
            
            // Check department budget
            if (department === 'marketing' && amount > 5000) {
                violations.push('Requires director approval (>$5,000)');
            }
            
            // Check for duplicate vendors
            if (Math.random() < 0.1) {
                violations.push('Potential duplicate vendor payment');
            }
            
            return violations;
        }
        
        // Keyboard shortcuts for power users
        document.addEventListener('keydown', function(e) {
            if (e.altKey) {
                switch(e.key) {
                    case '1':
                        switchWorkflow('pending');
                        break;
                    case '2':
                        switchWorkflow('review');
                        break;
                    case '3':
                        switchWorkflow('escalated');
                        break;
                    case 'a':
                        if (selectedExpenses.size > 0) {
                            bulkApprove();
                        }
                        break;
                    case 'r':
                        if (selectedExpenses.size > 0) {
                            bulkReject();
                        }
                        break;
                }
            }
        });
        
        // Initialize workflow
        document.addEventListener('DOMContentLoaded', function() {
            filterExpensesByWorkflow('pending');
            autoRefresh();
        });
        
        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
        
        // Performance optimization for enterprise approval workflows
        // Progressive enhancement - works without JavaScript for core approval functionality
        // JavaScript enhances with real-time updates, bulk operations, and workflow automation
    </script>
</body>
</html>